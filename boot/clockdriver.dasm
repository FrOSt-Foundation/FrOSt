; clock basic driver

#define CLOCK_SET_SPEED 0
#define CLOCK_GET_TICKS 1
#define CLOCK_SET_INT 2

:clockSpeed .dat 0

; entry - in A the HW ID
:clockInit
  set push, A
  set push, B
  set A, CLOCK_SET_SPEED
  set B, 0
  hwi peek
  set A, CLOCK_SET_INT
  set B, CLOCK_MESSAGE
  hwi peek
  set B, pop
  set A, pop
  set PC, pop

; entry - A HW ID, B speed
:clocksetSpeed
  set [clockSpeed], B
  set push, B
  set push, A
  set A, CLOCK_SET_SPEED
  hwi peek
  set A, pop
  set B, pop
  set PC, pop
